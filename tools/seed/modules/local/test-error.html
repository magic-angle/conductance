<script>
var dump = function(desc, e) {
	console.log('-----', desc + ": " + e);
	console.log("e._magic_foo = ", e._magic_foo);
	try {
		console.log("e.proto = ", Object.getPrototypeOf(e));
	} catch(e) {
		console.log("Can't get proto of e, typeof(e) = " + typeof(e));
		// console.log(e.
		console.log(e.toString + '');
		for (var k in e) {
			console.log('  '+k+'='+e[k]);
		}
	}
	console.log('-----');
}

window.onerror = function(str, loc, line, col, err) {
	// console.log(arguments);
	dump('onerror', str);
	if(err) {
		dump('onerror', err);
		console.error(err.toString());
		return true;
	}
}

var MyError = function(m) {
	this.message = m;
	this._magic_foo = "yes!";
};
MyError.prototype = new Error("MyError");
MyError.prototype.toString = function() {
	return "[MyError: " + this.message + "]";
};

var makeError = function() {
	(function outer() {
		(function inner() {
			throw new MyError("fail");
		})();
	})();
};
try {
	makeError();
} catch(e) {
	dump('catch', e);
}
makeError();
</script>
